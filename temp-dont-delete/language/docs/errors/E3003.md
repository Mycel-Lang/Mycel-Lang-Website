# Error E3003: Environment variable access denied

## Summary

This error occurs when a function attempts to read an environment variable from the system without being explicitly granted permission in the `mycel.toml` configuration file.

---

## The Problem

Access to environment variables is restricted by default because they can contain sensitive information, such as API keys, passwords, or system configuration details. A function must be explicitly whitelisted to access specific environment variables.

**File: `main.mycel`**
```mycel
// This function call will fail if it tries to access an environment variable
// without permission.
@useApiKey()
```

**File: `mycel.toml`**
```toml
# No permissions are granted, so the function cannot access any env vars.
[tool.mycel.permissions]
```

## The Solution

Add an entry to your `mycel.toml` file that grants the function permission to read the specific environment variable(s) it needs.

**File: `mycel.toml` (Fixed)**
```toml
[tool.mycel.permissions]

# Grant the @useApiKey function read access to the "API_KEY" environment variable.
"env://API_KEY" = { permissions = ["read"], functions = ["@useApiKey"] }
```

---

## Detailed Explanation

Environment variables are a common source of security vulnerabilities. A malicious package could try to read all your environment variables and send them to a remote server. To prevent this, Mycel's security sandbox blocks all access to environment variables by default.

When a function attempts to read an environment variable (e.g., `getenv("API_KEY")`), the compiler intercepts the call. It checks for a rule in `mycel.toml` that explicitly grants the function permission to read that specific variable.

The permission rule must:

1.  Use the `env://` protocol prefix.
2.  Specify the exact name of the environment variable.
3.  Include `"read"` in its `permissions` array.
4.  Include the function's name in its `functions` array.

If no matching rule is found, the request is denied, and the compiler reports error `E3003`. This ensures that no function can access potentially sensitive information from your environment without your explicit consent.

As a best practice, you should only grant access to the specific variables a function needs to do its job, rather than granting broad access.
